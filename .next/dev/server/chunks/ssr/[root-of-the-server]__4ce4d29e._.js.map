{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/Downloads/pos-booking-system/components/booking/booking-complete-modal.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport jsPDF from \"jspdf\"\nimport type { Booking } from \"@/lib/storage\"\n\ninterface BookingCompleteModalProps {\n  booking: Booking\n  clientName: string\n  accommodationName: string\n  checkIn: string\n  checkOut: string\n  nights: number\n  onClose: () => void\n}\n\nexport default function BookingCompleteModal({\n  booking,\n  clientName,\n  accommodationName,\n  checkIn,\n  checkOut,\n  nights,\n  onClose,\n}: BookingCompleteModalProps) {\n  const [isGeneratingPDF, setIsGeneratingPDF] = useState(false)\n\n  const generatePDFReceipt = () => {\n    setIsGeneratingPDF(true)\n\n    try {\n      const doc = new jsPDF()\n      const pageWidth = doc.internal.pageSize.getWidth()\n      const pageHeight = doc.internal.pageSize.getHeight()\n\n      // Set colors\n      const blueColor = [30, 58, 138] // #1E3A8A\n      const yellowColor = [250, 204, 21] // #FACC15\n      const grayColor = [50, 50, 50]\n\n      // Header with background\n      doc.setFillColor(...blueColor)\n      doc.rect(0, 0, pageWidth, 40, \"F\")\n\n      doc.setTextColor(250, 204, 21)\n      doc.setFontSize(28)\n      doc.setFont(\"helvetica\", \"bold\")\n      doc.text(\"SISOY POS\", pageWidth / 2, 20, { align: \"center\" })\n\n      doc.setTextColor(255, 255, 255)\n      doc.setFontSize(10)\n      doc.text(\"BOOKING RECEIPT\", pageWidth / 2, 32, { align: \"center\" })\n\n      // Receipt details\n      let yPosition = 50\n\n      // Booking ID and Date\n      doc.setTextColor(...grayColor)\n      doc.setFontSize(10)\n      doc.setFont(\"helvetica\", \"normal\")\n\n      doc.text(`Booking ID: ${booking.id}`, 20, yPosition)\n      yPosition += 8\n      doc.text(`Date Issued: ${new Date().toLocaleDateString()}`, 20, yPosition)\n      yPosition += 12\n\n      // Divider\n      doc.setDrawColor(...blueColor)\n      doc.line(20, yPosition, pageWidth - 20, yPosition)\n      yPosition += 10\n\n      // Guest Information\n      doc.setFont(\"helvetica\", \"bold\")\n      doc.setFontSize(11)\n      doc.setTextColor(...blueColor)\n      doc.text(\"GUEST INFORMATION\", 20, yPosition)\n      yPosition += 8\n\n      doc.setFont(\"helvetica\", \"normal\")\n      doc.setFontSize(10)\n      doc.setTextColor(...grayColor)\n      doc.text(`Name: ${clientName}`, 25, yPosition)\n      yPosition += 6\n      doc.text(`Booking Date: ${new Date(booking.createdAt).toLocaleDateString()}`, 25, yPosition)\n      yPosition += 12\n\n      // Accommodation Details\n      doc.setFont(\"helvetica\", \"bold\")\n      doc.setFontSize(11)\n      doc.setTextColor(...blueColor)\n      doc.text(\"ACCOMMODATION DETAILS\", 20, yPosition)\n      yPosition += 8\n\n      doc.setFont(\"helvetica\", \"normal\")\n      doc.setFontSize(10)\n      doc.setTextColor(...grayColor)\n      doc.text(`Accommodation: ${accommodationName}`, 25, yPosition)\n      yPosition += 6\n      doc.text(`Check-In: ${new Date(checkIn).toLocaleDateString()}`, 25, yPosition)\n      yPosition += 6\n      doc.text(`Check-Out: ${new Date(checkOut).toLocaleDateString()}`, 25, yPosition)\n      yPosition += 6\n      doc.text(`Number of Nights: ${nights}`, 25, yPosition)\n      yPosition += 12\n\n      // Billing Summary\n      doc.setFont(\"helvetica\", \"bold\")\n      doc.setFontSize(11)\n      doc.setTextColor(...blueColor)\n      doc.text(\"BILLING SUMMARY\", 20, yPosition)\n      yPosition += 8\n\n      // Summary table\n      const tableData = [\n        [\"Description\", \"Amount\"],\n        [`${accommodationName} x ${nights} nights`, `₱${booking.totalAmount.toLocaleString()}`],\n        [\"Discount\", \"₱0.00\"],\n        [\"Service Charge\", \"₱0.00\"],\n        [\"Tax (0%)\", \"₱0.00\"],\n      ]\n\n      doc.setFontSize(10)\n      doc.setTextColor(...grayColor)\n\n      tableData.forEach((row, index) => {\n        const isHeader = index === 0\n        if (isHeader) doc.setFont(\"helvetica\", \"bold\")\n        else doc.setFont(\"helvetica\", \"normal\")\n\n        doc.text(row[0], 25, yPosition)\n        doc.text(row[1], pageWidth - 40, yPosition, { align: \"right\" })\n        yPosition += 6\n      })\n\n      // Total\n      yPosition += 2\n      doc.setDrawColor(...blueColor)\n      doc.line(20, yPosition, pageWidth - 20, yPosition)\n      yPosition += 6\n\n      doc.setFont(\"helvetica\", \"bold\")\n      doc.setFontSize(12)\n      doc.setTextColor(...blueColor)\n      doc.text(\"TOTAL AMOUNT\", 25, yPosition)\n      doc.text(`₱${booking.totalAmount.toLocaleString()}`, pageWidth - 40, yPosition, { align: \"right\" })\n\n      yPosition += 14\n\n      // Payment Info\n      doc.setDrawColor(...blueColor)\n      doc.line(20, yPosition, pageWidth - 20, yPosition)\n      yPosition += 8\n\n      doc.setFont(\"helvetica\", \"bold\")\n      doc.setFontSize(10)\n      doc.setTextColor(...blueColor)\n      doc.text(\"PAYMENT INFORMATION\", 20, yPosition)\n      yPosition += 8\n\n      doc.setFont(\"helvetica\", \"normal\")\n      doc.setFontSize(10)\n      doc.setTextColor(...grayColor)\n      doc.text(`Payment Status: PAID`, 25, yPosition)\n      yPosition += 6\n      doc.text(`Transaction ID: ${booking.transactionId}`, 25, yPosition)\n      yPosition += 12\n\n      // Footer\n      doc.setDrawColor(...blueColor)\n      doc.line(20, yPosition, pageWidth - 20, yPosition)\n      yPosition += 8\n\n      doc.setFont(\"helvetica\", \"italic\")\n      doc.setFontSize(9)\n      doc.setTextColor(150, 150, 150)\n      doc.text(\"Thank you for booking with Sisoy POS\", pageWidth / 2, yPosition, { align: \"center\" })\n      yPosition += 5\n      doc.text(\"For inquiries, please contact us\", pageWidth / 2, yPosition, { align: \"center\" })\n\n      // Save PDF\n      doc.save(`Receipt_${booking.id}.pdf`)\n    } catch (error) {\n      console.error(\"Error generating PDF:\", error)\n      alert(\"Failed to generate receipt. Please try again.\")\n    } finally {\n      setIsGeneratingPDF(false)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg p-8 max-w-md w-full shadow-2xl space-y-6 animate-in\">\n        {/* Success Icon */}\n        <div className=\"flex justify-center\">\n          <div className=\"bg-green-100 rounded-full p-4\">\n            <svg className=\"w-12 h-12 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n            </svg>\n          </div>\n        </div>\n\n        {/* Title */}\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-blue-900 mb-2\">Booking Complete!</h2>\n          <p className=\"text-gray-600 text-sm\">Your reservation has been confirmed</p>\n        </div>\n\n        {/* Booking Details */}\n        <div className=\"bg-blue-50 rounded-lg p-4 space-y-3 text-sm\">\n          <div className=\"flex justify-between\">\n            <span className=\"text-gray-600\">Booking ID</span>\n            <span className=\"font-bold text-gray-900\">{booking.id}</span>\n          </div>\n          <div className=\"flex justify-between\">\n            <span className=\"text-gray-600\">Room</span>\n            <span className=\"font-bold text-gray-900\">{accommodationName}</span>\n          </div>\n          <div className=\"flex justify-between\">\n            <span className=\"text-gray-600\">Nights</span>\n            <span className=\"font-bold text-gray-900\">{nights}</span>\n          </div>\n          <div className=\"border-t border-blue-200 pt-3 mt-3 flex justify-between\">\n            <span className=\"font-bold text-gray-800\">Total Amount</span>\n            <span className=\"font-bold text-yellow-500 text-lg\">₱{booking.totalAmount.toLocaleString()}</span>\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"space-y-3\">\n          <button\n            onClick={generatePDFReceipt}\n            disabled={isGeneratingPDF}\n            className=\"w-full py-3 bg-blue-900 text-white font-bold rounded hover:bg-blue-800 transition-colors disabled:opacity-50 flex items-center justify-center gap-2\"\n          >\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M12 19l9 2-9-18-9 18 9-2m0 0v-8m0 8l-6-4m6 4l6-4\"\n              />\n            </svg>\n            {isGeneratingPDF ? \"Generating...\" : \"Download Receipt PDF\"}\n          </button>\n          <button\n            onClick={onClose}\n            className=\"w-full py-3 bg-yellow-400 text-blue-900 font-bold rounded hover:bg-yellow-500 transition-colors\"\n          >\n            Done\n          </button>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 452, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/Downloads/pos-booking-system/app/%28dashboard%29/booking/payment/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { useRouter, useSearchParams } from \"next/navigation\"\nimport { storage } from \"@/lib/storage\"\nimport BookingCompleteModal from \"@/components/booking/booking-complete-modal\"\n\nexport default function PaymentPage() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  const amount = Number.parseFloat(searchParams.get(\"amount\") || \"0\")\n  const bookingId = searchParams.get(\"bookingId\") || \"\"\n\n  const [paymentMethod, setPaymentMethod] = useState(\"cash\")\n  const [isProcessing, setIsProcessing] = useState(false)\n  const [completedBooking, setCompletedBooking] = useState<any>(null)\n\n  const handleSimulatePayment = async () => {\n    setIsProcessing(true)\n\n    // Simulate API call\n    await new Promise((resolve) => setTimeout(resolve, 2000))\n\n    const tempBooking = JSON.parse(sessionStorage.getItem(\"tempBooking\") || \"{}\")\n\n    const booking = {\n      ...tempBooking,\n      id: bookingId || tempBooking.id,\n      status: \"confirmed\" as const,\n      paymentStatus: \"paid\" as const,\n      transactionId: `TXN${Date.now()}`,\n    }\n\n    const API_BASE = typeof process !== 'undefined' && process.env && process.env.NEXT_PUBLIC_API_URL ? process.env.NEXT_PUBLIC_API_URL : ''\n\n    // Try to create booking on server first when API is configured\n    if (typeof window !== 'undefined' && API_BASE) {\n      try {\n        // Ensure the customer exists on server. If the selected clientId is not a numeric DB id,\n        // attempt to create the customer first and replace customer_id with the returned id.\n        let customerIdToUse = booking.clientId\n\n        const isNumericId = /^[0-9]+$/.test(String(customerIdToUse))\n        if (!isNumericId) {\n          const clientObj = storage.getClients().find((c: any) => c.id === booking.clientId)\n          if (clientObj) {\n            try {\n              const createResp = await fetch(`${API_BASE}/customers.php?action=create`, {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({\n                  first_name: clientObj.firstName,\n                  last_name: clientObj.lastName,\n                  email: clientObj.email || '',\n                  phone: clientObj.phoneNumber || '',\n                  address: clientObj.address || '',\n                }),\n              })\n              if (createResp.ok) {\n                const cjson = await createResp.json()\n                if (cjson && cjson.id) {\n                  customerIdToUse = String(cjson.id)\n                  // update local client id to server id so subsequent operations use server id\n                  try {\n                    const clients = storage.getClients()\n                    const idx = clients.findIndex((c: any) => c.id === clientObj.id)\n                    if (idx !== -1) {\n                        clients[idx].id = customerIdToUse\n                        localStorage.setItem('pos_clients', JSON.stringify(clients))\n                      }\n                  } catch {}\n                }\n              }\n            } catch (e) {\n              // ignore and continue — booking will fallback to local if needed\n            }\n          }\n        }\n\n        const payload = {\n          customer_id: customerIdToUse,\n          accommodation_id: booking.accommodationId,\n          check_in: booking.dateFrom,\n          check_out: booking.dateTo,\n          guests: 1,\n          total_price: booking.totalAmount,\n        }\n\n        const resp = await fetch(`${API_BASE}/bookings.php?action=create`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify(payload),\n        })\n\n        if (resp.ok) {\n          const json = await resp.json()\n          const serverId = json && json.id ? String(json.id) : booking.id\n          const serverBooking = { ...booking, id: serverId }\n          // ensure booking references the server customer id\n          serverBooking.clientId = customerIdToUse\n          // write to local storage manually to avoid duplicate POST\n          try {\n            const existing = storage.getBookings() || []\n            existing.push(serverBooking)\n            localStorage.setItem('pos_bookings', JSON.stringify(existing))\n          } catch {}\n\n          sessionStorage.removeItem(\"tempBooking\")\n          setIsProcessing(false)\n          setCompletedBooking(serverBooking)\n          return\n        }\n      } catch (e) {\n        // fall back to local-only if server call fails\n      }\n    }\n\n    // Fallback local-only\n    storage.addBooking(booking)\n    sessionStorage.removeItem(\"tempBooking\")\n\n    setIsProcessing(false)\n    setCompletedBooking(booking)\n  }\n\n  const handleCloseModal = () => {\n    setCompletedBooking(null)\n    router.push(\"/dashboard\")\n  }\n\n  if (completedBooking) {\n    const client = storage.getClients().find((c) => c.id === completedBooking.clientId)\n    const accommodation = storage.getAccommodations().find((a) => a.id === completedBooking.accommodationId)\n\n    const checkIn = new Date(completedBooking.dateFrom)\n    const checkOut = new Date(completedBooking.dateTo)\n    const nights = Math.floor((checkOut.getTime() - checkIn.getTime()) / (1000 * 60 * 60 * 24))\n\n    return (\n      <BookingCompleteModal\n        booking={completedBooking}\n        clientName={client ? `${client.firstName} ${client.lastName}` : \"Guest\"}\n        accommodationName={accommodation?.name || \"Accommodation\"}\n        checkIn={completedBooking.dateFrom}\n        checkOut={completedBooking.dateTo}\n        nights={nights}\n        onClose={handleCloseModal}\n      />\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md bg-white border border-gray-200 rounded-lg p-8 shadow-lg\">\n        <h1 className=\"text-3xl font-bold text-blue-900 mb-6 text-center\">Confirm Payment</h1>\n\n        <div className=\"bg-blue-50 p-6 rounded mb-6 text-center border border-blue-200\">\n          <p className=\"text-sm text-gray-600 mb-2 font-medium\">Total Amount Due</p>\n          <p className=\"text-4xl font-bold text-yellow-500\">₱{amount.toLocaleString()}</p>\n        </div>\n\n        <div className=\"space-y-4 mb-6\">\n          <label className=\"block\">\n            <span className=\"block text-sm font-bold text-gray-700 mb-3\">Payment Method</span>\n            <select\n              value={paymentMethod}\n              onChange={(e) => setPaymentMethod(e.target.value)}\n              className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n            >\n              <option value=\"cash\">Cash Payment</option>\n              <option value=\"gcash\">GCash</option>\n              <option value=\"credit\">Credit Card</option>\n              <option value=\"bank\">Bank Transfer</option>\n            </select>\n          </label>\n        </div>\n\n        <button\n          onClick={handleSimulatePayment}\n          disabled={isProcessing}\n          className=\"w-full py-3 bg-yellow-400 text-blue-900 font-bold rounded-lg hover:bg-yellow-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n        >\n          {isProcessing ? \"Processing Payment...\" : \"Confirm & Process Payment\"}\n        </button>\n\n        <div className=\"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200 text-xs text-gray-700\">\n          <p className=\"font-bold mb-1 text-blue-900\">Payment Confirmation</p>\n          <p>Payment will be processed securely. A receipt will be generated upon completion.</p>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS;IACtB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,eAAe,IAAA,qJAAe;IACpC,MAAM,SAAS,OAAO,UAAU,CAAC,aAAa,GAAG,CAAC,aAAa;IAC/D,MAAM,YAAY,aAAa,GAAG,CAAC,gBAAgB;IAEnD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAC;IACnD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,CAAC,kBAAkB,oBAAoB,GAAG,IAAA,iNAAQ,EAAM;IAE9D,MAAM,wBAAwB;QAC5B,gBAAgB;QAEhB,oBAAoB;QACpB,MAAM,IAAI,QAAQ,CAAC,UAAY,WAAW,SAAS;QAEnD,MAAM,cAAc,KAAK,KAAK,CAAC,eAAe,OAAO,CAAC,kBAAkB;QAExE,MAAM,UAAU;YACd,GAAG,WAAW;YACd,IAAI,aAAa,YAAY,EAAE;YAC/B,QAAQ;YACR,eAAe;YACf,eAAe,CAAC,GAAG,EAAE,KAAK,GAAG,IAAI;QACnC;QAEA,MAAM,WAAW,OAAO,YAAY,eAAe,QAAQ,GAAG,gLAAwE;QAEtI,+DAA+D;QAC/D;;QAiFA,sBAAsB;QACtB,yHAAO,CAAC,UAAU,CAAC;QACnB,eAAe,UAAU,CAAC;QAE1B,gBAAgB;QAChB,oBAAoB;IACtB;IAEA,MAAM,mBAAmB;QACvB,oBAAoB;QACpB,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,kBAAkB;QACpB,MAAM,SAAS,yHAAO,CAAC,UAAU,GAAG,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,iBAAiB,QAAQ;QAClF,MAAM,gBAAgB,yHAAO,CAAC,iBAAiB,GAAG,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,iBAAiB,eAAe;QAEvG,MAAM,UAAU,IAAI,KAAK,iBAAiB,QAAQ;QAClD,MAAM,WAAW,IAAI,KAAK,iBAAiB,MAAM;QACjD,MAAM,SAAS,KAAK,KAAK,CAAC,CAAC,SAAS,OAAO,KAAK,QAAQ,OAAO,EAAE,IAAI,CAAC,OAAO,KAAK,KAAK,EAAE;QAEzF,qBACE,8OAAC,iKAAoB;YACnB,SAAS;YACT,YAAY,SAAS,GAAG,OAAO,SAAS,CAAC,CAAC,EAAE,OAAO,QAAQ,EAAE,GAAG;YAChE,mBAAmB,eAAe,QAAQ;YAC1C,SAAS,iBAAiB,QAAQ;YAClC,UAAU,iBAAiB,MAAM;YACjC,QAAQ;YACR,SAAS;;;;;;IAGf;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BAAoD;;;;;;8BAElE,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAE,WAAU;sCAAyC;;;;;;sCACtD,8OAAC;4BAAE,WAAU;;gCAAqC;gCAAE,OAAO,cAAc;;;;;;;;;;;;;8BAG3E,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC;wBAAM,WAAU;;0CACf,8OAAC;gCAAK,WAAU;0CAA6C;;;;;;0CAC7D,8OAAC;gCACC,OAAO;gCACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;gCAChD,WAAU;;kDAEV,8OAAC;wCAAO,OAAM;kDAAO;;;;;;kDACrB,8OAAC;wCAAO,OAAM;kDAAQ;;;;;;kDACtB,8OAAC;wCAAO,OAAM;kDAAS;;;;;;kDACvB,8OAAC;wCAAO,OAAM;kDAAO;;;;;;;;;;;;;;;;;;;;;;;8BAK3B,8OAAC;oBACC,SAAS;oBACT,UAAU;oBACV,WAAU;8BAET,eAAe,0BAA0B;;;;;;8BAG5C,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAE,WAAU;sCAA+B;;;;;;sCAC5C,8OAAC;sCAAE;;;;;;;;;;;;;;;;;;;;;;;AAKb"}}]
}