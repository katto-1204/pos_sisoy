module.exports=[46722,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(77577);function e(){let a,e,f,g,h,i,j,[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)({start:new Date(Date.now()-2592e6).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]});(0,c.useEffect)(()=>{l(d.storage.getBookings())},[]);let o=()=>k.filter(a=>{let b=a.dateFrom;return b>=m.start&&b<=m.end&&"cancelled"!==a.status}),p=(e=(a=o()).length,{totalBookings:e,totalRevenue:f=a.filter(a=>"paid"===a.paymentStatus).reduce((a,b)=>a+b.totalAmount,0),avgBookingValue:e>0?f/e:0}),q=(g=o(),h={},g.forEach(a=>{h[a.dateFrom]||(h[a.dateFrom]=0),h[a.dateFrom]+=a.totalAmount}),Object.entries(h).sort(([a],[b])=>a.localeCompare(b)).slice(-7)),r=(i=o(),j={},i.forEach(a=>{let b=d.storage.getAccommodations().find(b=>b.id===a.accommodationId);b&&(j[b.name]||(j[b.name]={count:0,revenue:0}),j[b.name].count++,j[b.name].revenue+=a.totalAmount)}),j);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-(--primary-blue)",children:"Reports"}),(0,b.jsxs)("div",{className:"bg-white border border-(--gray-light) rounded p-4 flex gap-4 items-end",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-(--gray-dark) mb-1",children:"From"}),(0,b.jsx)("input",{type:"date",value:m.start,onChange:a=>n({...m,start:a.target.value}),className:"px-3 py-2 border border-(--gray-light) rounded"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-(--gray-dark) mb-1",children:"To"}),(0,b.jsx)("input",{type:"date",value:m.end,onChange:a=>n({...m,end:a.target.value}),className:"px-3 py-2 border border-(--gray-light) rounded"})]}),(0,b.jsx)("button",{onClick:()=>{let a=new Blob([[["Date","Client","Accommodation","Amount","Status"],...o().map(a=>{let b=d.storage.getClients().find(b=>b.id===a.clientId),c=d.storage.getAccommodations().find(b=>b.id===a.accommodationId);return[a.dateFrom,`${b?.firstName} ${b?.lastName}`,c?.name,a.totalAmount,a.status]})].map(a=>a.join(",")).join("\n")],{type:"text/csv"}),b=window.URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download=`report-${m.start}.csv`,c.click()},className:"px-4 py-2 bg-(--yellow) text-(--gray-dark) rounded font-bold hover:bg-yellow-400",children:"Export CSV"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"bg-white border border-(--gray-light) rounded p-6",children:[(0,b.jsx)("p",{className:"text-sm text-(--gray-dark) mb-1",children:"Total Bookings"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-(--primary-blue)",children:p.totalBookings})]}),(0,b.jsxs)("div",{className:"bg-white border border-(--gray-light) rounded p-6",children:[(0,b.jsx)("p",{className:"text-sm text-(--gray-dark) mb-1",children:"Total Revenue"}),(0,b.jsxs)("p",{className:"text-3xl font-bold text-(--primary-blue)",children:["₱",p.totalRevenue.toLocaleString()]})]}),(0,b.jsxs)("div",{className:"bg-white border border-(--gray-light) rounded p-6",children:[(0,b.jsx)("p",{className:"text-sm text-(--gray-dark) mb-1",children:"Avg. Booking Value"}),(0,b.jsxs)("p",{className:"text-3xl font-bold text-(--primary-blue)",children:["₱",Math.round(p.avgBookingValue).toLocaleString()]})]})]}),(0,b.jsxs)("div",{className:"bg-white border border-(--gray-light) rounded p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-(--gray-dark) mb-4",children:"Last 7 Days Sales"}),(0,b.jsx)("div",{className:"space-y-2",children:q.map(([a,c])=>(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("span",{className:"w-24 text-sm font-bold",children:a}),(0,b.jsx)("div",{className:"flex-1 bg-(--gray-bg) rounded h-8 relative overflow-hidden",children:(0,b.jsx)("div",{className:"bg-(--yellow) h-full transition-all",style:{width:`${Math.min(100,c/Math.max(...q.map(a=>a[1]))*100)}%`}})}),(0,b.jsxs)("span",{className:"w-32 text-right font-bold",children:["₱",c.toLocaleString()]})]},a))})]}),(0,b.jsxs)("div",{className:"bg-white border border-(--gray-light) rounded p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-(--gray-dark) mb-4",children:"Accommodation Performance"}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-(--gray-bg) border-b border-(--gray-light)",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"text-left py-2 px-4 font-bold",children:"Accommodation"}),(0,b.jsx)("th",{className:"text-left py-2 px-4 font-bold",children:"Bookings"}),(0,b.jsx)("th",{className:"text-left py-2 px-4 font-bold",children:"Revenue"}),(0,b.jsx)("th",{className:"text-left py-2 px-4 font-bold",children:"Avg/Booking"})]})}),(0,b.jsx)("tbody",{children:Object.entries(r).map(([a,c])=>(0,b.jsxs)("tr",{className:"border-b border-(--gray-light)",children:[(0,b.jsx)("td",{className:"py-3 px-4",children:a}),(0,b.jsx)("td",{className:"py-3 px-4 font-bold",children:c.count}),(0,b.jsxs)("td",{className:"py-3 px-4 font-bold",children:["₱",c.revenue.toLocaleString()]}),(0,b.jsxs)("td",{className:"py-3 px-4",children:["₱",Math.round(c.revenue/c.count).toLocaleString()]})]},a))})]})})]})]})}a.s(["default",()=>e])}];

//# sourceMappingURL=app_%28dashboard%29_reports_page_tsx_512dabf0._.js.map